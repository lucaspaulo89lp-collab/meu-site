<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Tiger Memory</title>
  <meta name="description" content="Jogo da mem√≥ria com Tiger Coins fict√≠cias. Sem apostas. Apenas entretenimento." />
  <script src="../wallet.js"></script>
  <style>
    :root{
      --stroke: rgba(255,255,255,.14);
      --card: rgba(255,255,255,.06);
      --card2: rgba(255,255,255,.05);
      --r: 18px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
      color: var(--pt-text);
    }
    .wrap{max-width:1000px;margin:0 auto;padding:18px}
    .top{
      display:flex;justify-content:space-between;align-items:flex-start;gap:12px;flex-wrap:wrap;
      margin-bottom:12px;
    }
    h1{margin:6px 0 4px;font-size:22px}
    p{margin:0;color:var(--pt-muted);line-height:1.55}
    .btn{
      display:inline-flex;gap:10px;align-items:center;
      padding:10px 12px;border-radius:14px;border:1px solid var(--stroke);
      background: var(--card);font-weight:900;color:inherit;text-decoration:none;
    }
    .panel{
      display:grid;grid-template-columns: 1.2fr .8fr;gap:12px;align-items:stretch;
    }
    .card{
      border:1px solid var(--stroke);
      background: var(--card);
      border-radius: 22px;
      padding: 14px;
      box-shadow: 0 18px 40px rgba(0,0,0,.30);
      backdrop-filter: blur(10px);
    }
    .hud{
      display:flex;gap:10px;flex-wrap:wrap;margin-top:10px
    }
    .pill{
      padding:8px 10px;border-radius:999px;border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      font-weight:900;font-size:13px;color:rgba(255,255,255,.92);
    }
    .primary{
      border:0;
      background: linear-gradient(135deg, var(--pt-brand), var(--pt-brand2));
      color:#06111f;
      cursor:pointer;
    }
    .ghost{
      cursor:pointer;
      background: rgba(255,255,255,.06);
    }

    /* tabuleiro */
    .board{
      display:grid;
      grid-template-columns: repeat(4, 1fr);
      gap:10px;
      margin-top:12px;
    }
    .tile{
      position:relative;
      height:110px;
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.05);
      cursor:pointer;
      overflow:hidden;
      transform-style: preserve-3d;
      transition: transform .18s ease;
      user-select:none;
    }
    .tile.disabled{cursor:default;opacity:.7}
    .tile.flipped{transform: rotateY(180deg)}
    .face{
      position:absolute; inset:0;
      display:grid; place-items:center;
      backface-visibility: hidden;
      font-weight: 1000;
      font-size: 34px;
      letter-spacing: .5px;
    }
    .back{
      background:
        radial-gradient(300px 160px at 30% 20%, color-mix(in srgb, var(--pt-brand) 18%, transparent), transparent 65%),
        rgba(0,0,0,.18);
      color: rgba(255,255,255,.92);
    }
    .front{
      transform: rotateY(180deg);
      background: rgba(255,255,255,.07);
    }

    /* Skin aplicada via data-skin (wallet.js) */
    body[data-skin="classic"] .front{
      background: linear-gradient(135deg, rgba(54,211,153,.16), rgba(86,208,255,.10));
    }
    body[data-skin="neon"] .front{
      background: linear-gradient(135deg, rgba(86,208,255,.22), rgba(155,135,255,.16));
      box-shadow: inset 0 0 0 2px rgba(86,208,255,.10);
    }
    body[data-skin="gold"] .front{
      background: linear-gradient(135deg, rgba(255,210,90,.22), rgba(255,240,200,.12));
      box-shadow: inset 0 0 0 2px rgba(255,210,90,.10);
    }

    .note{
      margin-top:10px;
      padding:12px 14px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
      color: rgba(255,255,255,.86);
      font-size: 13px;
      line-height: 1.55;
    }

    @media (max-width: 980px){
      .panel{grid-template-columns:1fr}
      .board{grid-template-columns: repeat(3, 1fr);}
      .tile{height:105px}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="top">
      <div>
        <h1>üß† Tiger Memory</h1>
        <p>Encontre os pares. Ganhe <b>Tiger Coins</b> (fict√≠cias) ao vencer. Sem apostas.</p>
      </div>
      <a class="btn" href="../index.html">‚Üê Voltar</a>
    </div>

    <div class="panel">
      <div class="card">
        <div class="hud">
          <span class="pill" id="moves">Tentativas: 0</span>
          <span class="pill" id="matches">Pares: 0/8</span>
          <span class="pill" id="pack">Pack: starter</span>
          <button class="btn primary" id="newGame">Novo jogo</button>
        </div>

        <div class="board" id="board"></div>
      </div>

      <div class="card">
        <h1 style="font-size:16px;margin:0 0 6px;">Recompensas</h1>
        <p style="margin:0;color:var(--pt-muted);line-height:1.55;">
          Voc√™ ganha Coins ao vencer. Quanto menos tentativas, maior o b√¥nus.
        </p>

        <div class="note">
          <b>Base:</b> 6 Coins ao vencer<br/>
          <b>B√¥nus:</b> +4 Coins (‚â§ 14 tentativas) ‚Ä¢ +2 Coins (‚â§ 18 tentativas)
        </div>

        <div class="note">
          <b>Aviso legal:</b> Coins s√£o fict√≠cias e n√£o podem ser convertidas em dinheiro real.
        </div>

        <div class="note">
          <b>Dica:</b> V√° na <a href="../store/" style="text-decoration:underline">Loja</a> e teste skins e temas.
        </div>
      </div>
    </div>
  </div>

  <script>
    const ICONS = ["üêÖ","üåø","‚≠ê","‚ö°","üçÄ","üßä","üî•","üíé"]; // 8 pares
    const boardEl = document.getElementById("board");
    const movesEl = document.getElementById("moves");
    const matchesEl = document.getElementById("matches");
    const packEl = document.getElementById("pack");
    const newGameBtn = document.getElementById("newGame");

    let tiles = [];
    let flipped = [];
    let locked = false;
    let moves = 0;
    let matches = 0;

    function pack(){
      const s = PT.getSettings();
      return (document.body.dataset.levelpack || s.levelPack || "starter");
    }

    function applyPack(){
      const p = pack();
      packEl.textContent = "Pack: " + p;

      // Packs afetam "dificuldade" via embaralhamento + penalidade de tempo (simples)
      // starter: normal
      // easy: mostra tudo 1.2s no in√≠cio
      // pro: mostra tudo 0.6s no in√≠cio
    }

    function shuffle(arr){
      for(let i=arr.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [arr[i],arr[j]] = [arr[j],arr[i]];
      }
      return arr;
    }

    function createBoard(){
      boardEl.innerHTML = "";
      const pairs = [...ICONS, ...ICONS];
      shuffle(pairs);

      tiles = pairs.map((icon, idx) => {
        const d = document.createElement("div");
        d.className = "tile";
        d.dataset.icon = icon;
        d.dataset.idx = String(idx);
        d.innerHTML = `
          <div class="face back">?</div>
          <div class="face front">${icon}</div>
        `;
        d.addEventListener("click", () => onTile(d));
        boardEl.appendChild(d);
        return d;
      });
    }

    function setStats(){
      movesEl.textContent = "Tentativas: " + moves;
      matchesEl.textContent = `Pares: ${matches}/8`;
    }

    function flip(tile){
      tile.classList.add("flipped");
      tile.classList.add("disabled");
    }
    function unflip(tile){
      tile.classList.remove("flipped");
      tile.classList.remove("disabled");
    }

    function onTile(tile){
      if(locked) return;
      if(tile.classList.contains("matched")) return;
      if(tile.classList.contains("flipped")) return;

      flip(tile);
      flipped.push(tile);

      if(flipped.length === 2){
        locked = true;
        moves++;
        setStats();

        const [a,b] = flipped;
        const same = a.dataset.icon === b.dataset.icon;

        setTimeout(() => {
          if(same){
            a.classList.add("matched");
            b.classList.add("matched");
            matches++;
            setStats();

            if(matches === 8){
              reward();
            }
          }else{
            unflip(a);
            unflip(b);
          }
          flipped = [];
          locked = false;
        }, 520);
      }
    }

    function reward(){
      const base = 6;
      let bonus = 0;
      if(moves <= 14) bonus = 4;
      else if(moves <= 18) bonus = 2;

      // pack: pro d√° +1 coin (mas √© mais dif√≠cil); easy tira -1 (mais f√°cil)
      const p = pack();
      let packAdj = 0;
      if(p === "pro") packAdj = 1;
      if(p === "easy") packAdj = -1;

      const total = Math.max(1, base + bonus + packAdj);
      PT.addCoins(total);

      setTimeout(() => {
        alert(`üéâ Voc√™ venceu! +${total} Tiger Coins üêÖ\nTentativas: ${moves}\n\n(As moedas s√£o fict√≠cias e n√£o t√™m valor real.)`);
      }, 80);
    }

    function revealStart(){
      const p = pack();
      const ms = (p === "easy") ? 1200 : (p === "pro") ? 600 : 900;

      tiles.forEach(t => t.classList.add("flipped","disabled"));
      setTimeout(() => {
        tiles.forEach(t => {
          t.classList.remove("flipped","disabled");
        });
      }, ms);
    }

    function newGame(){
      moves = 0;
      matches = 0;
      flipped = [];
      locked = false;
      applyPack();
      createBoard();
      setStats();
      revealStart();
    }

    document.addEventListener("DOMContentLoaded", () => {
      PT.ensureHUD();
      PT.applyCosmetics();
      newGameBtn.addEventListener("click", newGame);
      newGame();
    });
  </script>
</body>
</html>
